%绘制2010年、2013年、2016年东海表层POC浓度逐月对比图和分布图
clear; clc;
InPath = 'data\monthly\poc\';

%分月份读取数据
name = {{'A20100012010031.L3m_MO_POC_poc_4km.nc',...
        'A20100322010059.L3m_MO_POC_poc_4km.nc',...
        'A20100602010090.L3m_MO_POC_poc_4km.nc',...
        'A20100912010120.L3m_MO_POC_poc_4km.nc',...
        'A20101212010151.L3m_MO_POC_poc_4km.nc',...
        'A20101522010181.L3m_MO_POC_poc_4km.nc',...
        'A20101822010212.L3m_MO_POC_poc_4km.nc',...
        'A20102132010243.L3m_MO_POC_poc_4km.nc',...
        'A20102442010273.L3m_MO_POC_poc_4km.nc',...
        'A20102742010304.L3m_MO_POC_poc_4km.nc',...
        'A20103052010334.L3m_MO_POC_poc_4km.nc',...
        'A20103352010365.L3m_MO_POC_poc_4km.nc'},...
        {'A20130012013031.L3m_MO_POC_poc_4km.nc',...
        'A20130322013059.L3m_MO_POC_poc_4km.nc',...
        'A20130602013090.L3m_MO_POC_poc_4km.nc',...
        'A20130912013120.L3m_MO_POC_poc_4km.nc',...
        'A20131212013151.L3m_MO_POC_poc_4km.nc',...
        'A20131522013181.L3m_MO_POC_poc_4km.nc',...
        'A20131822013212.L3m_MO_POC_poc_4km.nc',...
        'A20132132013243.L3m_MO_POC_poc_4km.nc',...
        'A20132442013273.L3m_MO_POC_poc_4km.nc',...
        'A20132742013304.L3m_MO_POC_poc_4km.nc',...
        'A20133052013334.L3m_MO_POC_poc_4km.nc',...
        'A20133352013365.L3m_MO_POC_poc_4km.nc'},...
        {'A20160012016031.L3m_MO_POC_poc_4km.nc',...
        'A20160322016060.L3m_MO_POC_poc_4km.nc',...
        'A20160612016091.L3m_MO_POC_poc_4km.nc',...
        'A20160922016121.L3m_MO_POC_poc_4km.nc',...
        'A20161222016152.L3m_MO_POC_poc_4km.nc',...
        'A20161532016182.L3m_MO_POC_poc_4km.nc',...
        'A20161832016213.L3m_MO_POC_poc_4km.nc',...
        'A20162142016244.L3m_MO_POC_poc_4km.nc',...
        'A20162452016274.L3m_MO_POC_poc_4km.nc',...
        'A20162752016305.L3m_MO_POC_poc_4km.nc',...
        'A20163062016335.L3m_MO_POC_poc_4km.nc',...
        'A20163362016366.L3m_MO_POC_poc_4km.nc'}};

%计算表层浓度均值
sum = ones(3, 12);
for i = 1:3
    figure(i);
    for k = 1:12
        [poc,Lat,Lon] = read_x_nc(InPath, name{i}{k}, 'poc');
        ind1 = find(Lon>117,1);
        ind2 = find(Lon>131,1);
        lon1 = Lon(ind1:ind2);
        ind3 = find(Lat<23,1);
        ind4 = find(Lat<34,1);
        lat1 = Lat(ind4:ind3);
        POC = poc(ind1:ind2,ind4:ind3);
        sum(i,k) = get_POC(POC);
        subplot(4, 3, k);
        POC(POC>500) = 500;
        draw_map(lat1, lon1, POC, 'POC');
    end
    set(gcf, 'unit', 'centimeters', 'position', [0 0 30 50]);
    fname=['figures/POC_monthly_contrast_', num2str(2007+3*i), '.fig']; %以年份为文件名保存
    saveas(gcf, fname);
end

%绘制图像
figure(4);

a = sum(1,:); %2010年数据
b = sum(2,:); %2013年数据
c = sum(3,:); %2016年数据

x = 1:1:12;
p = plot(x, a, '-*b', x, b, '-*r', x, c, '-*g');
set(gcf, 'unit', 'centimeters', 'position', [1 5 20 10]);
fontsize = 16;
set(gca, 'linewidth', 1, 'fontsize', fontsize, 'fontname', 'Times New Roman');
ylabel('\itc\rm(POC) (mg/m^3)', 'fontsize', fontsize, 'fontname', 'Times New Roman');   
xlabel('Month', 'fontsize', fontsize, 'fontname', 'Times New Roman');
h = legend(p, '2010', '2013', '2016', 'Location', 'NorthEast');
axis([1, 12, 50, 250]);
set(gca,'XTick', [1:1:12]);
set(gca,'YTick', [50:50:250]);

%保存图片
saveas(gcf,'figures/POC_monthly_contrast.fig');